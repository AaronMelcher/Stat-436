---
title: "Homework 2 - Interactive Shiny App"
author: "Aaron Melcher"
date: "`r Sys.Date()`"
---
```{r, echo = FALSE}
knitr::opts_chunk$set(warnings = FALSE, message = FALSE)
```

```{r}
library(tidyverse)
library(ggplot2)
library(shiny)
theme_set(theme_classic())

# Data setup - gathering sets and 
ballon_dor <- read_csv("BallonDOr.csv")

nationalities <- pull(ballon_dor, Nationality) |>
  unique() |>
  na.omit()

years <- pull(ballon_dor, Year) |>
  unique() |>
  na.omit()

ranks <- c(1, 2, 3, 4, 5)

winners_data <- function() {
  ballon_dor |>
  group_by(Year) |>
  summarise(Winner = Player[Rank == 1],
            Total_Points = Points[Rank == 1],
            Nationality = Nationality[Rank == 1],
            Club = Club[Rank == 1],
            Rank_Points = RankPts[Rank == 1],
            Share = Share[Rank == 1],
            Percent = Percent[Rank == 1]
            ) |>
  arrange(Year)
}
```

```{r, eval=FALSE}
### shiny app definition
ui <- fluidPage(
  titlePanel("Ballon d'Or Rankings Analysis"),
  fluidRow(
   column(6,
          h4("Select Ballon d'Or Rank (1-5):"),
          checkboxGroupInput("ranks", "Ranks", ranks, ranks, inline = TRUE)
   ),
   column(6,
          h4("Filter years (1956-2023):"),
          sliderInput("year", "Year", min = min(years), max = max(years), c(1956, 2023), sep = "")
   )
  ),
  fluidRow(
    column(6,
          plotOutput("rankDist")
    ),
    column(6,
          plotOutput("countryWins")
    )
  ),
  fluidRow(
    column(12,
           h4("Ballon D'Or Rankings Table"),
           dataTableOutput("playerTable")
    )
  )
)

server <- function(input, output) {
  # Density plot for point distribution by rank
  output$rankDist <- renderPlot({
    ggplot(, aes(x = Points)) +
      geom_density(fill = "lightblue") +
      labs(x = "Points", y = "Density", title = "Density Plot of Points Distribution by Rank")
  })
}

shinyApp(ui, server)
```