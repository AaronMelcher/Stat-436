---
title: "Homework 2 - Interactive Shiny App"
author: "Aaron Melcher"
date: "`r Sys.Date()`"
#runtime: shiny
---

```{r, echo = FALSE}
knitr::opts_chunk$set(warnings = FALSE, message = FALSE)
library(tidyverse)
library(ggplot2)
library(shiny)
```

```{r}
# Data setup - gathering sets and 
ballon_dor <- read_csv("BallonDOr.csv")

nationalities <- pull(ballon_dor, Nationality) |>
  unique() |>
  na.omit()

years <- pull(ballon_dor, Year) |>
  unique() |>
  na.omit()

winners <- ballon_dor |>
  group_by(Year) |>
  summarise(Winner = Player[Rank == 1],
            Total_Points = Points[Rank == 1],
            Nationality = Nationality[Rank == 1],
            Club = Club[Rank == 1],
            Rank_Points = RankPts[Rank == 1],
            Share = Share[Rank == 1],
            Percent = Percent[Rank == 1]
            ) |>
  arrange(Year)
```

```{r}
wins_by_country <- winners |>
  count(Nationality, name="Wins") |>
  arrange(desc(Wins))
  
ggplot(wins_by_country, aes(reorder(Nationality, Wins), Wins)) +
  geom_bar(stat = "identity") +
  coord_flip() +
  labs(
    title = "Number of Ballon D'Or Wins by Country ",
    x = "Country",
    y = "Number of Wins"
  ) +
  theme_minimal()
```